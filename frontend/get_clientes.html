<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
</head>
<body>
    <h1>Clientes</h1>
    <table id="tabla_clientes">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody id="tbody_clientes">
            <tr>
                <td>1</td>
                <td>Rodrigo</td>
                <td>rodri@email.com</td>
            </tr>
        </tbody>
    </table>
    <script>
        function getClientes(){
    var query = window.location.search.substring(1);
    console.log("Query: " + query)

    //Conectar con el backend
    var request = new XMLHttpRequest();
    username= sessionStorage.getItem("username");
    password= sessionStorage.getItem("password");

    console.log("Username: " + username);
    console.log("Password: " + password);

    request.open('GET', 'http://127.0.0.1:8000/', true);
    request.setRequestHeader("Accept", "application/json");

    request.onload = () => {
        const response = request.response.responseText;
        const json = JSON.parse(response);
        console.log("Response " + response);
        console.log("Json " +  json);

        var tbody = document.getElementById("tbody_clientes");

        for(let row=0; row<json.length; row++){
            var tr = document.createElement('tr');
            var id_clientes = document.createElement('td');
            var nombre = document.createElement('td');
            var email = document.createElement('td');

            id_clientes.innerHTML = json[i].id_clientes;
            nombre.innerHTML = json[i].nombre;
            email.innerHTML = json[i].emil;

            tr.appendChild(id_clientes);
            tr.appendChild(nombre);
            tr.appendChild(email);

            tbody.appendChild(tr);

        }
    
    };
    request.send();
};
document.body.onload =getClientes
    </script>
</body>
</html>